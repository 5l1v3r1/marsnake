from core.ueba.classifier import base_classifier
from core.ueba.timeline import KUEBA_timeline
from core.ueba import macro

class malware_detect(base_classifier):
	def __init__(self):
		self.kind = macro.EVENTS["MALWARE_DETECT"]
		self.pathname = None
		self.report = None
		
	def publish(self, *args, **kwargs):
		if self.pathname and self.report:
			KUEBA_timeline().publish([{
				"kind" : self.kind,
				"extra" : {
					"pathname" : self.pathname,
					"report" : self.report
				}
			}])